(this["webpackJsonpimessage-clone"]=this["webpackJsonpimessage-clone"]||[]).push([[0],{53:function(e,a,t){e.exports=t(81)},58:function(e,a,t){},73:function(e,a,t){},74:function(e,a,t){},75:function(e,a,t){},76:function(e,a,t){},78:function(e,a,t){},79:function(e,a,t){},80:function(e,a,t){},81:function(e,a,t){"use strict";t.r(a);var n=t(0),c=t.n(n),l=t(14),o=t.n(l),r=(t(58),t(22)),i=t.n(r),s=i.a.initializeApp({apiKey:"AIzaSyD_4CJe2g9Is95fhXNZ9oKdU63rNmazEks",authDomain:"imessage-clone-89256.firebaseapp.com",databaseURL:"https://imessage-clone-89256.firebaseio.com",projectId:"imessage-clone-89256",storageBucket:"imessage-clone-89256.appspot.com",messagingSenderId:"1018585831633",appId:"1:1018585831633:web:d4f1e4c21c808ef5bf0df0",measurementId:"G-W1C8X9RGDE"}).firestore(),m=i.a.auth(),u=new i.a.auth.GoogleAuthProvider,d=s,h=t(9),p=(t(73),t(20)),f=Object(p.b)({name:"user",initialState:{user:null},reducers:{login:function(e,a){e.user=a.payload},logout:function(e){e.user=null}}}),E=f.actions,g=E.login,v=E.logout,b=function(e){return e.user.user},N=f.reducer,_=(t(74),t(16)),j=t(95),O=t(93),S=(t(75),t(44)),y=t.n(S),I=t(45),k=t.n(I),w=Object(p.b)({name:"chat",initialState:{chatId:null,chatName:null},reducers:{setChat:function(e,a){e.chatId=a.payload.chatId,e.chatName=a.payload.chatName}}}),C=w.actions.setChat,D=function(e){return e.chat.chatName},B=function(e){return e.chat.chatId},A=w.reducer,M=(t(76),t(48));var L=function(e){var a,t,l,o,r=e.id,i=e.chatName,s=Object(h.b)(),m=Object(n.useState)([]),u=Object(_.a)(m,2),p=u[0],f=u[1];return Object(n.useEffect)((function(){d.collection("chats").doc(r).collection("messages").orderBy("timestamp","desc").onSnapshot((function(e){return f(e.docs.map((function(e){return e.data()})))}))}),[r]),c.a.createElement("div",{onClick:function(){return s(C({chatId:r,chatName:i}))},className:"sidebarChat"},c.a.createElement(j.a,{src:null===(a=p[0])||void 0===a?void 0:a.photo}),c.a.createElement("div",{className:"sidebarChat__info"},c.a.createElement("h3",null,i),c.a.createElement("p",null,null===(t=p[0])||void 0===t?void 0:t.message),c.a.createElement("small",null,M.a(new Date(null===(l=p[0])||void 0===l||null===(o=l.timestamp)||void 0===o?void 0:o.toDate()).toLocaleString()))))};var R=function(){var e=Object(h.c)(b),a=Object(n.useState)([]),t=Object(_.a)(a,2),l=t[0],o=t[1];return Object(n.useEffect)((function(){d.collection("chats").onSnapshot((function(e){return o(e.docs.map((function(e){return{id:e.id,data:e.data()}})))}))}),[]),c.a.createElement("div",{className:"sidebar"},c.a.createElement("div",{className:"sidebar__header"},c.a.createElement(j.a,{onClick:function(){return m.signOut()},src:e.photo,className:"sidebar__avatar"}),c.a.createElement("div",{className:"sidebar__input"},c.a.createElement(y.a,null),c.a.createElement("input",{placeholder:"Search"})),c.a.createElement(O.a,{variant:"outlined",className:"sidebar__inputButton"},c.a.createElement(k.a,{onClick:function(){var e=prompt("Please enter a chat name");e&&d.collection("chats").add({chatName:e})}}))),c.a.createElement("div",{className:"sidebar__chats"},l.map((function(e){var a=e.id,t=e.data.chatName;return c.a.createElement(L,{key:a,id:a,chatName:t})}))))},W=(t(78),t(47)),z=t.n(W),G=(t(79),Object(n.forwardRef)((function(e,a){e.id;var t=e.contents,n=t.timestamp,l=(t.displayName,t.email),o=t.message,r=t.photo,i=(t.uid,Object(h.c)(b));return c.a.createElement("div",{ref:a,className:"message ".concat(i.email===l&&"message__sender")},c.a.createElement(j.a,{className:"message__photo",src:r}),c.a.createElement("p",null,o),c.a.createElement("small",null,new Date(null===n||void 0===n?void 0:n.toDate()).toLocaleString()))}))),J=t(46);var P=function(){var e=Object(h.c)(b),a=Object(n.useState)(""),t=Object(_.a)(a,2),l=t[0],o=t[1],r=Object(h.c)(D),s=Object(h.c)(B),m=Object(n.useState)([]),u=Object(_.a)(m,2),p=u[0],f=u[1];return Object(n.useEffect)((function(){s&&d.collection("chats").doc(s).collection("messages").orderBy("timestamp","desc").onSnapshot((function(e){return f(e.docs.map((function(e){return{id:e.id,data:e.data()}})))}))}),[s]),c.a.createElement("div",{className:"chat"},c.a.createElement("div",{className:"chat__header"},c.a.createElement("h4",null,"To: ",c.a.createElement("span",{className:"chat__name"},r)),c.a.createElement("strong",null,"Details")),c.a.createElement("div",{className:"chat__messages"},c.a.createElement(J.a,null,p.map((function(e){var a=e.id,t=e.data;return c.a.createElement(G,{key:a,contents:t})})))),c.a.createElement("div",{className:"chat__input"},c.a.createElement("form",null,c.a.createElement("input",{value:l,onChange:function(e){return o(e.target.value)},placeholder:"iMessage",type:"text"}),c.a.createElement("button",{onClick:function(a){a.preventDefault(),d.collection("chats").doc(s).collection("messages").add({timestamp:i.a.firestore.FieldValue.serverTimestamp(),message:l,uid:e.uid,photo:e.photo,email:e.email,displayName:e.displayName}),o("")}},"Send Message")),c.a.createElement(O.a,null,c.a.createElement(z.a,{className:"chat__mic"}))))};var U=function(){return c.a.createElement("div",{className:"imessage"},c.a.createElement(R,null),c.a.createElement(P,null))},x=t(94);t(80);var K=function(){return c.a.createElement("div",{className:"login"},c.a.createElement("div",{className:"login__logo"},c.a.createElement("img",{src:"https://upload.wikimedia.org/wikipedia/commons/5/56/IMessage_logo_%28Apple_Inc.%29.png",alt:""}),c.a.createElement("h1",null,"iMessage")),c.a.createElement(x.a,{onClick:function(){m.signInWithPopup(u).catch((function(e){return alert(e.message)}))}},"Sign In"))};var T=function(){var e=Object(h.c)(b),a=Object(h.b)();return Object(n.useEffect)((function(){m.onAuthStateChanged((function(e){a(e?g({uid:e.uid,photo:e.photoURL,email:e.email,displayName:e.displayName}):v())}))}),[]),c.a.createElement("div",{className:"app"},e?c.a.createElement(U,null):c.a.createElement(K,null))},X=Object(p.a)({reducer:{user:N,chat:A}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(h.a,{store:X},c.a.createElement(T,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[53,1,2]]]);
//# sourceMappingURL=main.ee4f1d52.chunk.js.map